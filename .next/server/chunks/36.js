exports.id=36,exports.ids=[36],exports.modules={3091:(e,t,i)=>{"use strict";var s,n="function"==typeof setImmediate;function r(e){a.length||(d(),h=!0),a[a.length]=e}e.exports=r;var a=[],h=!1,o=0;function l(){for(;o<a.length;){var e=o;if(o+=1,a[e].call(),o>1024){for(var t=0,i=a.length-o;t<i;t++)a[t]=a[t+o];a.length-=o,o=0}}a.length=0,o=0,h=!1}function d(){var e=process.domain;e&&(s||(s=i(21994)),s.active=process.domain=null),h&&n?setImmediate(l):process.nextTick(l),e&&(s.active=process.domain=e)}r.requestFlush=d},15624:(e,t,i)=>{var s=i(93432);function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function r(e){var t=function(){if(t.called)throw Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)};return t.onceError=(e.name||"Function wrapped with `once`")+" shouldn't be called more than once",t.called=!1,t}e.exports=s(n),e.exports.strict=s(r),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return r(this)},configurable:!0})})},32744:(e,t,i)=>{e.exports=i(93432)(function(e){var t=!0;return s(function(){t=!1}),function(){var i=arguments,n=this;t?s(function(){e.apply(n,i)}):e.apply(n,i)}});var s=i(53824)},53824:(e,t,i)=>{"use strict";var s=i(3091),n=[];function r(){this.task=null,this.domain=null}e.exports=function(e){var t;(t=n.length?n.pop():new r).task=e,t.domain=process.domain,s(t)},r.prototype.call=function(){this.domain&&this.domain.enter();var e=!0;try{this.task.call(),e=!1,this.domain&&this.domain.exit()}finally{e&&s.requestFlush(),this.task=null,this.domain=null,n.push(this)}}},88036:(e,t,i)=>{"use strict";i.r(t),i.d(t,{DummyParser:()=>ea,File:()=>o,Formidable:()=>ep,IncomingForm:()=>ep,JSONParser:()=>ei,MultipartParser:()=>X,OctetStreamParser:()=>A,OctetstreamParser:()=>A,PersistentFile:()=>o,QueryStringParser:()=>x,QuerystringParser:()=>x,VolatileFile:()=>d,default:()=>e_,defaultOptions:()=>eo,enabledPlugins:()=>em,errors:()=>s,formidable:()=>ef,json:()=>es,multipart:()=>ee,octetstream:()=>F,querystring:()=>T});var s={};i.r(s),i.d(s,{aborted:()=>O,biggerThanMaxFileSize:()=>V,biggerThanTotalMaxFileSize:()=>B,cannotCreateDir:()=>W,default:()=>q,filenameNotString:()=>P,malformedMultipart:()=>H,maxFieldsExceeded:()=>z,maxFieldsSizeExceeded:()=>L,maxFilesExceeded:()=>j,missingContentType:()=>C,missingMultipartBoundary:()=>M,missingPlugin:()=>R,noEmptyFiles:()=>I,noParser:()=>k,pluginFailed:()=>Y,pluginFunction:()=>v,smallerThanMinFileSize:()=>U,uninitializedParser:()=>N,unknownTransferEncoding:()=>$});var n=i(73024),r=i(77598),a=i(78474);class h extends a.EventEmitter{constructor({filepath:e,newFilename:t,originalFilename:i,mimetype:s,hashAlgorithm:n}){super(),this.lastModifiedDate=null,Object.assign(this,{filepath:e,newFilename:t,originalFilename:i,mimetype:s,hashAlgorithm:n}),this.size=0,this._writeStream=null,"string"==typeof this.hashAlgorithm?this.hash=r.createHash(this.hashAlgorithm):this.hash=null}open(){this._writeStream=n.createWriteStream(this.filepath),this._writeStream.on("error",e=>{this.emit("error",e)})}toJSON(){let e={size:this.size,filepath:this.filepath,newFilename:this.newFilename,mimetype:this.mimetype,mtime:this.lastModifiedDate,length:this.length,originalFilename:this.originalFilename};return this.hash&&""!==this.hash&&(e.hash=this.hash),e}toString(){return`PersistentFile: ${this.newFilename}, Original: ${this.originalFilename}, Path: ${this.filepath}`}write(e,t){if(this.hash&&this.hash.update(e),this._writeStream.closed)return void t();this._writeStream.write(e,()=>{this.lastModifiedDate=new Date,this.size+=e.length,this.emit("progress",this.size),t()})}end(e){this.hash&&(this.hash=this.hash.digest("hex")),this._writeStream.end(()=>{this.emit("end"),e()})}destroy(){this._writeStream.destroy();let e=this.filepath;setTimeout(function(){n.unlink(e,()=>{})},1)}}let o=h;class l extends a.EventEmitter{constructor({filepath:e,newFilename:t,originalFilename:i,mimetype:s,hashAlgorithm:n,createFileWriteStream:a}){super(),this.lastModifiedDate=null,Object.assign(this,{filepath:e,newFilename:t,originalFilename:i,mimetype:s,hashAlgorithm:n,createFileWriteStream:a}),this.size=0,this._writeStream=null,"string"==typeof this.hashAlgorithm?this.hash=(0,r.createHash)(this.hashAlgorithm):this.hash=null}open(){this._writeStream=this.createFileWriteStream(this),this._writeStream.on("error",e=>{this.emit("error",e)})}destroy(){this._writeStream.destroy()}toJSON(){let e={size:this.size,newFilename:this.newFilename,length:this.length,originalFilename:this.originalFilename,mimetype:this.mimetype};return this.hash&&""!==this.hash&&(e.hash=this.hash),e}toString(){return`VolatileFile: ${this.originalFilename}`}write(e,t){if(this.hash&&this.hash.update(e),this._writeStream.closed||this._writeStream.destroyed)return void t();this._writeStream.write(e,()=>{this.size+=e.length,this.emit("progress",this.size),t()})}end(e){this.hash&&(this.hash=this.hash.digest("hex")),this._writeStream.end(()=>{this.emit("end"),e()})}}let d=l;for(var u=i(48161),c=i(76760),p=i(51455),f=i(46193),m=256,_=[];m--;)_[m]=(m+256).toString(16).substring(1);var g=i(15624),b=i(32744),y=i(57075);class E extends y.PassThrough{constructor(e={}){super(),this.globalOptions={...e}}}let A=E;async function F(e,t){let i=this||e;return/octet-stream/i.test(i.headers["content-type"])&&await S.call(i,i,t),i}async function S(e,t){this.type="octet-stream";let i=this.headers["x-file-name"],s=this.headers["content-type"],n=this._getNewName({originalFilename:i,mimetype:s}),r=this._joinDirectoryName(n),a=await this._newFile({newFilename:n,filepath:r,originalFilename:i,mimetype:s});this.emit("fileBegin",i,a),a.open(),this.openedFiles.push(a),this._flushing+=1,this._parser=new A(this.options);let h=0;return this._parser.on("data",e=>{this.pause(),h+=1,a.write(e,()=>{h-=1,this.resume(),this.ended&&this._parser.emit("doneWritingFile")})}),this._parser.on("end",()=>{this._flushing-=1,this.ended=!0;let e=()=>{a.end(()=>{this.emit("file","file",a),this._maybeEnd()})};0===h?e():this._parser.once("doneWritingFile",e)}),this}class w extends y.Transform{constructor(e={}){super({readableObjectMode:!0}),this.globalOptions={...e},this.buffer="",this.bufferLength=0}_transform(e,t,i){this.buffer+=e.toString("ascii"),this.bufferLength=this.buffer.length,i()}_flush(e){for(let[e,t]of new URLSearchParams(this.buffer))this.push({key:e,value:t});this.buffer="",e()}}let x=w;function T(e,t){let i=this||e;return/urlencoded/i.test(i.headers["content-type"])&&D.call(i,i,t),i}function D(e,t){this.type="urlencoded";let i=new x(this.options);return i.on("data",({key:e,value:t})=>{this.emit("field",e,t)}),i.once("end",()=>{this.ended=!0,this._maybeEnd()}),this._parser=i,this}let R=1e3,v=1001,O=1002,k=1003,N=1004,P=1005,L=1006,z=1007,U=1008,B=1009,I=1010,C=1011,H=1012,M=1013,$=1014,j=1015,V=1016,Y=1017,W=1018,q=class extends Error{constructor(e,t,i=500){super(e),this.code=t,this.httpCode=i}},J=0,Z={PARSER_UNINITIALIZED:J++,START:J++,START_BOUNDARY:J++,HEADER_FIELD_START:J++,HEADER_FIELD:J++,HEADER_VALUE_START:J++,HEADER_VALUE:J++,HEADER_VALUE_ALMOST_DONE:J++,HEADERS_ALMOST_DONE:J++,PART_DATA_START:J++,PART_DATA:J++,PART_END:J++,END:J++},Q={PART_BOUNDARY:1,LAST_BOUNDARY:2},G={};Object.keys(Z).forEach(e=>{G[e]=Z[e]});class K extends y.Transform{constructor(e={}){super({readableObjectMode:!0}),this.boundary=null,this.boundaryChars=null,this.lookbehind=null,this.bufferLength=0,this.state=Z.PARSER_UNINITIALIZED,this.globalOptions={...e},this.index=null,this.flags=0}_endUnexpected(){return new q(`MultipartParser.end(): stream ended unexpectedly: ${this.explain()}`,H,400)}_flush(e){this.state===Z.HEADER_FIELD_START&&0===this.index||this.state===Z.PART_DATA&&this.index===this.boundary.length?(this._handleCallback("partEnd"),this._handleCallback("end"),e()):this.state!==Z.END?e(this._endUnexpected()):e()}initWithBoundary(e){this.boundary=Buffer.from(`\r
--${e}`),this.lookbehind=Buffer.alloc(this.boundary.length+8),this.state=Z.START,this.boundaryChars={};for(let e=0;e<this.boundary.length;e++)this.boundaryChars[this.boundary[e]]=!0}_handleCallback(e,t,i,s){(void 0===i||i!==s)&&this.push({name:e,buffer:t,start:i,end:s})}_transform(e,t,i){let s=0,n=this.index,{index:r,state:a,flags:h}=this,{lookbehind:o,boundary:l,boundaryChars:d}=this,u=l.length,c=u-1;this.bufferLength=e.length;let p=null,f=null,m=(e,t)=>{this[`${e}Mark`]="number"==typeof t?t:s},_=e=>{delete this[`${e}Mark`]},g=(t,i)=>{let n=`${t}Mark`;n in this&&(i?(this._handleCallback(t,e,this[n],s),_(t)):(this._handleCallback(t,e,this[n],e.length),m(t,0)))};for(s=0;s<this.bufferLength;s++)switch(p=e[s],a){case Z.PARSER_UNINITIALIZED:i(this._endUnexpected());return;case Z.START:r=0,a=Z.START_BOUNDARY;case Z.START_BOUNDARY:if(r===l.length-2){if(45===p)h|=Q.LAST_BOUNDARY;else if(13!==p)return void i(this._endUnexpected());r++;break}if(r-1==l.length-2){if(h&Q.LAST_BOUNDARY&&45===p)this._handleCallback("end"),a=Z.END,h=0;else{if(h&Q.LAST_BOUNDARY||10!==p)return void i(this._endUnexpected());r=0,this._handleCallback("partBegin"),a=Z.HEADER_FIELD_START}break}p!==l[r+2]&&(r=-2),p===l[r+2]&&r++;break;case Z.HEADER_FIELD_START:a=Z.HEADER_FIELD,m("headerField"),r=0;case Z.HEADER_FIELD:if(13===p){_("headerField"),a=Z.HEADERS_ALMOST_DONE;break}if(r++,45===p)break;if(58===p){if(1===r)return void i(this._endUnexpected());g("headerField",!0),a=Z.HEADER_VALUE_START;break}if((f=32|p)<97||f>122)return void i(this._endUnexpected());break;case Z.HEADER_VALUE_START:if(32===p)break;m("headerValue"),a=Z.HEADER_VALUE;case Z.HEADER_VALUE:13===p&&(g("headerValue",!0),this._handleCallback("headerEnd"),a=Z.HEADER_VALUE_ALMOST_DONE);break;case Z.HEADER_VALUE_ALMOST_DONE:if(10!==p)return void i(this._endUnexpected());a=Z.HEADER_FIELD_START;break;case Z.HEADERS_ALMOST_DONE:if(10!==p)return void i(this._endUnexpected());this._handleCallback("headersEnd"),a=Z.PART_DATA_START;break;case Z.PART_DATA_START:a=Z.PART_DATA,m("partData");case Z.PART_DATA:if(n=r,0===r){for(s+=c;s<this.bufferLength&&!(e[s]in d);)s+=u;s-=c,p=e[s]}if(r<l.length)l[r]===p?(0===r&&g("partData",!0),r++):r=0;else if(r===l.length)r++,13===p?h|=Q.PART_BOUNDARY:45===p?h|=Q.LAST_BOUNDARY:r=0;else if(r-1===l.length)if(h&Q.PART_BOUNDARY){if(r=0,10===p){h&=~Q.PART_BOUNDARY,this._handleCallback("partEnd"),this._handleCallback("partBegin"),a=Z.HEADER_FIELD_START;break}}else h&Q.LAST_BOUNDARY&&45===p?(this._handleCallback("partEnd"),this._handleCallback("end"),a=Z.END,h=0):r=0;r>0?o[r-1]=p:n>0&&(this._handleCallback("partData",o,0,n),n=0,m("partData"),s--);break;case Z.END:break;default:i(this._endUnexpected());return}return g("headerField"),g("headerValue"),g("partData"),this.index=r,this.state=a,this.flags=h,i(),this.bufferLength}explain(){return`state = ${K.stateToString(this.state)}`}}K.stateToString=e=>{for(let t in Z)if(Z[t]===e)return t};let X=Object.assign(K,{STATES:G});function ee(e,t){let i=this||e;if(/multipart/i.test(i.headers["content-type"])){let e=i.headers["content-type"].match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(e){var s;(s=e[1]||e[2],function(){let e,t,i;this.type="multipart";let n=new X(this.options);n.initWithBoundary(s),n.on("data",async({name:s,buffer:r,start:a,end:h})=>{if("partBegin"===s)(i=new y.Stream).readable=!0,i.headers={},i.name=null,i.originalFilename=null,i.mimetype=null,i.transferEncoding=this.options.encoding,i.transferBuffer="",e="",t="";else if("headerField"===s)e+=r.toString(this.options.encoding,a,h);else if("headerValue"===s)t+=r.toString(this.options.encoding,a,h);else if("headerEnd"===s){e=e.toLowerCase(),i.headers[e]=t;let s=t.match(/\bname=("([^"]*)"|([^\(\)<>@,;:\\"\/\[\]\?=\{\}\s\t/]+))/i);"content-disposition"===e?(s&&(i.name=s[2]||s[3]||""),i.originalFilename=this._getFileName(t)):"content-type"===e?i.mimetype=t:"content-transfer-encoding"===e&&(i.transferEncoding=t.toLowerCase()),e="",t=""}else if("headersEnd"===s){switch(i.transferEncoding){case"binary":case"7bit":case"8bit":case"utf-8":{let e=e=>{"partData"===e.name&&i.emit("data",e.buffer.slice(e.start,e.end))},t=s=>{"partEnd"===s.name&&(i.emit("end"),n.off("data",e),n.off("data",t))};n.on("data",e),n.on("data",t);break}case"base64":{let e=e=>{if("partData"===e.name){i.transferBuffer+=e.buffer.slice(e.start,e.end).toString("ascii");let t=4*parseInt(i.transferBuffer.length/4,10);i.emit("data",Buffer.from(i.transferBuffer.substring(0,t),"base64")),i.transferBuffer=i.transferBuffer.substring(t)}},t=s=>{"partEnd"===s.name&&(i.emit("data",Buffer.from(i.transferBuffer,"base64")),i.emit("end"),n.off("data",e),n.off("data",t))};n.on("data",e),n.on("data",t);break}default:return this._error(new q("unknown transfer-encoding",$,501))}this._parser.pause(),await this.onPart(i),this._parser.resume()}else"end"===s&&(this.ended=!0,this._maybeEnd())}),this._parser=n}).call(i,i,t)}else{let e=new q("bad content-type header, no multipart boundary",M,400);i._error(e)}}return i}class et extends y.Transform{constructor(e={}){super({readableObjectMode:!0}),this.chunks=[],this.globalOptions={...e}}_transform(e,t,i){this.chunks.push(String(e)),i()}_flush(e){try{let e=JSON.parse(this.chunks.join(""));this.push(e)}catch(t){e(t);return}this.chunks=null,e()}}let ei=et;function es(e,t){let i=this||e;return/json/i.test(i.headers["content-type"])&&en.call(i,i,t),i}function en(e,t){this.type="json";let i=new ei(this.options);i.on("data",e=>{this.fields=e}),i.once("end",()=>{this.ended=!0,this._maybeEnd()}),this._parser=i}class er extends y.Transform{constructor(e,t={}){super(),this.globalOptions={...t},this.incomingForm=e}_flush(e){this.incomingForm.ended=!0,this.incomingForm._maybeEnd(),e()}}let ea=er,eh=function(e){e=e||16;var t="",i=0;return function(){if(!t||256===i){for(t="",i=(1+e)/2|0;i--;)t+=_[256*Math.random()|0];t=t.substring(i=0,e-2)}return t+_[i++]}}(25),eo={maxFields:1e3,maxFieldsSize:0x1400000,maxFiles:1/0,maxFileSize:0xc800000,maxTotalFileSize:void 0,minFileSize:1,allowEmptyFiles:!1,createDirsFromUploads:!1,keepExtensions:!1,encoding:"utf-8",hashAlgorithm:!1,uploadDir:u.tmpdir(),enabledPlugins:[F,T,ee,es],fileWriteStreamHandler:null,defaultInvalidName:"invalid-name",filter:e=>!0,filename:void 0};function el(e,t){return Object.prototype.hasOwnProperty.call(e,t)}let ed=function(e){let t=Promise.resolve();return async function(...i){let s,n,r=t;return t=new Promise(function(e){n=e}),await r,(s=e(...i)).then(n).catch(n),s}}(function(e){let t=c.dirname(e);return p.mkdir(t,{recursive:!0})}),eu=e=>{let t=e.charCodeAt(0);return!(46===t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)};class ec extends a.EventEmitter{constructor(e={}){super(),this.options={...eo,...e},this.options.maxTotalFileSize||(this.options.maxTotalFileSize=this.options.maxFileSize);let t=c.resolve(this.options.uploadDir||this.options.uploaddir||u.tmpdir());if(this.uploaddir=t,this.uploadDir=t,["error","headers","type","bytesExpected","bytesReceived","_parser","req"].forEach(e=>{this[e]=null}),this._setUpRename(),this._flushing=0,this._fieldsSize=0,this._totalFileSize=0,this._plugins=[],this.openedFiles=[],this.options.enabledPlugins=[].concat(this.options.enabledPlugins).filter(Boolean),0===this.options.enabledPlugins.length)throw new q("expect at least 1 enabled builtin plugin, see options.enabledPlugins",R);this.options.enabledPlugins.forEach(e=>{this.use(e)}),this._setUpMaxFields(),this._setUpMaxFiles(),this.ended=void 0,this.type=void 0}use(e){if("function"!=typeof e)throw new q(".use: expect `plugin` to be a function",v);return this._plugins.push(e.bind(this)),this}pause(){try{this.req.pause()}catch(e){return this.ended||this._error(e),!1}return!0}resume(){try{this.req.resume()}catch(e){return this.ended||this._error(e),!1}return!0}async parse(e,t){let i;if(this.req=e,!t){let e,s;i=new Promise((t,i)=>{e=t,s=i}),t=(t,i,n)=>{t?s(t):e([i,n])}}let s=g(b(t));this.fields={};let n={};return(this.on("field",(e,t)=>{"multipart"===this.type||"urlencoded"===this.type?el(this.fields,e)?this.fields[e].push(t):this.fields[e]=[t]:this.fields[e]=t}),this.on("file",(e,t)=>{el(n,e)?n[e].push(t):n[e]=[t]}),this.on("error",e=>{s(e,this.fields,n)}),this.on("end",()=>{s(null,this.fields,n)}),await this.writeHeaders(e.headers),e.on("error",e=>{this._error(e)}).on("aborted",()=>{this.emit("aborted"),this._error(new q("Request aborted",O))}).on("data",e=>{try{this.write(e)}catch(e){this._error(e)}}).on("end",()=>{!this.error&&this._parser&&this._parser.end()}),i)?i:this}async writeHeaders(e){if(this.headers=e,this._parseContentLength(),await this._parseContentType(),!this._parser)return void this._error(new q("no parser found",k,415));this._parser.once("error",e=>{this._error(e)})}write(e){return this.error?null:this._parser?(this.bytesReceived+=e.length,this.emit("progress",this.bytesReceived,this.bytesExpected),this._parser.write(e),this.bytesReceived):(this._error(new q("uninitialized parser",N)),null)}onPart(e){return this._handlePart(e)}async _handlePart(e){if(e.originalFilename&&"string"!=typeof e.originalFilename)return void this._error(new q("the part.originalFilename should be string when it exists",P));if(!e.mimetype){let t="",i=new f.StringDecoder(e.transferEncoding||this.options.encoding);e.on("data",e=>{if(this._fieldsSize+=e.length,this._fieldsSize>this.options.maxFieldsSize)return void this._error(new q(`options.maxFieldsSize (${this.options.maxFieldsSize} bytes) exceeded, received ${this._fieldsSize} bytes of field data`,L,413));t+=i.write(e)}),e.on("end",()=>{this.emit("field",e.name,t)});return}if(!this.options.filter(e))return;this._flushing+=1;let t=0,i=this._getNewName(e),s=this._joinDirectoryName(i),n=await this._newFile({newFilename:i,filepath:s,originalFilename:e.originalFilename,mimetype:e.mimetype});n.on("error",e=>{this._error(e)}),this.emit("fileBegin",e.name,n),n.open(),this.openedFiles.push(n),e.on("data",e=>{if(this._totalFileSize+=e.length,t+=e.length,this._totalFileSize>this.options.maxTotalFileSize)return void this._error(new q(`options.maxTotalFileSize (${this.options.maxTotalFileSize} bytes) exceeded, received ${this._totalFileSize} bytes of file data`,B,413));0!==e.length&&(this.pause(),n.write(e,()=>{this.resume()}))}),e.on("end",()=>this.options.allowEmptyFiles||0!==t?t<this.options.minFileSize?void this._error(new q(`options.minFileSize (${this.options.minFileSize} bytes) inferior, received ${t} bytes of file data`,U,400)):t>this.options.maxFileSize?void this._error(new q(`options.maxFileSize (${this.options.maxFileSize} bytes), received ${t} bytes of file data`,V,413)):void n.end(()=>{this._flushing-=1,this.emit("file",e.name,n),this._maybeEnd()}):void this._error(new q("options.allowEmptyFiles is false, file size should be greater than 0",I,400)))}async _parseContentType(){if(0===this.bytesExpected){this._parser=new ea(this,this.options);return}if(!this.headers["content-type"])return void this._error(new q("bad content-type header, no content-type",C,400));new ea(this,this.options),await Promise.all(this._plugins.map(async(e,t)=>{let i=null;try{i=await e(this,this.options)||this}catch(i){let e=new q(`plugin on index ${t} failed with: ${i.message}`,Y,500);throw e.idx=t,e}Object.assign(this,i),this.emit("plugin",t,i)})),this.emit("pluginsResults",[])}_error(e,t="error"){this.error||this.ended||(this.req=null,this.error=e,this.emit(t,e),this.openedFiles.forEach(e=>{e.destroy()}))}_parseContentLength(){this.bytesReceived=0,this.headers["content-length"]?this.bytesExpected=parseInt(this.headers["content-length"],10):void 0===this.headers["transfer-encoding"]&&(this.bytesExpected=0),null!==this.bytesExpected&&this.emit("progress",this.bytesReceived,this.bytesExpected)}_newParser(){return new X(this.options)}async _newFile({filepath:e,originalFilename:t,mimetype:i,newFilename:s}){if(this.options.fileWriteStreamHandler)return new d({newFilename:s,filepath:e,originalFilename:t,mimetype:i,createFileWriteStream:this.options.fileWriteStreamHandler,hashAlgorithm:this.options.hashAlgorithm});if(this.options.createDirsFromUploads)try{await ed(e)}catch(e){this._error(new q("cannot create directory",W,409))}return new o({newFilename:s,filepath:e,originalFilename:t,mimetype:i,hashAlgorithm:this.options.hashAlgorithm})}_getFileName(e){let t=e.match(/\bfilename=("(.*?)"|([^()<>{}[\]@,;:"?=\s/\t]+))($|;\s)/i);if(!t)return null;let i=t[2]||t[3]||"",s=i.substr(i.lastIndexOf("\\")+1);return(s=s.replace(/%22/g,'"')).replace(/&#([\d]{4});/g,(e,t)=>String.fromCharCode(t))}_getExtension(e){let t;if(!e)return"";let i=c.basename(e),s=i.indexOf("."),n=i.lastIndexOf("."),r=c.extname(i);s!==n&&(r=i.slice(s));let a=Array.from(r).findIndex(eu);return"."===(t=-1===a?r:r.substring(0,a))?"":t}_joinDirectoryName(e){let t=c.join(this.uploadDir,e);return t.startsWith(this.uploadDir)?t:c.join(this.uploadDir,this.options.defaultInvalidName)}_setUpRename(){"function"==typeof this.options.filename?this._getNewName=e=>{let t="",i=this.options.defaultInvalidName;return e.originalFilename&&({ext:t,name:i}=c.parse(e.originalFilename),!0!==this.options.keepExtensions&&(t="")),this.options.filename.call(this,i,t,e,this)}:this._getNewName=e=>{let t=eh();if(e&&this.options.keepExtensions){let i="string"==typeof e?e:e.originalFilename;return`${t}${this._getExtension(i)}`}return t}}_setUpMaxFields(){if(this.options.maxFields!==1/0){let e=0;this.on("field",()=>{(e+=1)>this.options.maxFields&&this._error(new q(`options.maxFields (${this.options.maxFields}) exceeded`,z,413))})}}_setUpMaxFiles(){if(this.options.maxFiles!==1/0){let e=0;this.on("fileBegin",()=>{(e+=1)>this.options.maxFiles&&this._error(new q(`options.maxFiles (${this.options.maxFiles}) exceeded`,j,413))})}}_maybeEnd(){!this.ended||this._flushing||this.error||(this.req=null,this.emit("end"))}}let ep=ec,ef=(...e)=>new ep(...e),{enabledPlugins:em}=eo,e_=ef},93432:e=>{e.exports=function e(t,i){if(t&&i)return e(t)(i);if("function"!=typeof t)throw TypeError("need wrapper function");return Object.keys(t).forEach(function(e){s[e]=t[e]}),s;function s(){for(var e=Array(arguments.length),i=0;i<e.length;i++)e[i]=arguments[i];var s=t.apply(this,e),n=e[e.length-1];return"function"==typeof s&&s!==n&&Object.keys(n).forEach(function(e){s[e]=n[e]}),s}}}};